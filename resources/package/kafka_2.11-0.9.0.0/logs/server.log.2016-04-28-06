[2016-04-28 08:18:03,169] INFO Partition [pipeline,1] on broker 1: Shrinking ISR for partition [pipeline,1] from 1,2 to 1 (kafka.cluster.Partition)
[2016-04-28 08:18:03,373] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-04-28 08:18:03,375] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-04-28 08:18:03,375] INFO 1 successfully elected as leader (kafka.server.ZookeeperLeaderElector)
[2016-04-28 08:18:03,419] INFO re-registering broker info in ZK for broker 1 (kafka.server.KafkaHealthcheck)
[2016-04-28 08:18:03,457] INFO Partition [pipeline,1] on broker 1: Expanding ISR for partition [pipeline,1] from 1 to 1,2 (kafka.cluster.Partition)
[2016-04-28 08:18:06,306] INFO Creating /brokers/ids/1 (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-04-28 08:18:06,308] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-04-28 08:18:06,308] INFO Registered broker 1 at path /brokers/ids/1 with addresses: PLAINTEXT -> EndPoint(10.0.0.9,9092,PLAINTEXT) (kafka.utils.ZkUtils)
[2016-04-28 08:18:06,308] INFO done re-registering broker (kafka.server.KafkaHealthcheck)
[2016-04-28 08:18:06,308] INFO Subscribing to /brokers/topics path to watch for new topics (kafka.server.KafkaHealthcheck)
[2016-04-28 08:18:06,354] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions [pipeline,1] (kafka.server.ReplicaFetcherManager)
[2016-04-28 08:18:06,354] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions  (kafka.server.ReplicaFetcherManager)
[2016-04-28 08:18:06,355] INFO [ReplicaFetcherManager on broker 1] Added fetcher for partitions List() (kafka.server.ReplicaFetcherManager)
[2016-04-28 08:18:06,357] INFO New leader is 1 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-04-28 08:22:38,006] INFO Partition [pipeline,1] on broker 1: Shrinking ISR for partition [pipeline,1] from 1,2 to 1 (kafka.cluster.Partition)
[2016-04-28 08:22:40,222] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-04-28 08:22:40,223] INFO Partition [pipeline,1] on broker 1: Expanding ISR for partition [pipeline,1] from 1 to 1,2 (kafka.cluster.Partition)
[2016-04-28 08:22:40,224] INFO Result of znode creation is: NODEEXISTS (kafka.utils.ZKCheckedEphemeral)
[2016-04-28 08:22:40,226] INFO re-registering broker info in ZK for broker 1 (kafka.server.KafkaHealthcheck)
[2016-04-28 08:22:41,707] INFO Creating /brokers/ids/1 (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-04-28 08:22:41,710] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-04-28 08:22:41,711] INFO Registered broker 1 at path /brokers/ids/1 with addresses: PLAINTEXT -> EndPoint(10.0.0.9,9092,PLAINTEXT) (kafka.utils.ZkUtils)
[2016-04-28 08:22:41,711] INFO done re-registering broker (kafka.server.KafkaHealthcheck)
[2016-04-28 08:22:41,711] INFO Subscribing to /brokers/topics path to watch for new topics (kafka.server.KafkaHealthcheck)
[2016-04-28 08:22:41,724] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-04-28 08:22:41,724] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-04-28 08:22:41,724] INFO 1 successfully elected as leader (kafka.server.ZookeeperLeaderElector)
[2016-04-28 08:22:41,753] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions [pipeline,1] (kafka.server.ReplicaFetcherManager)
[2016-04-28 08:22:41,754] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions  (kafka.server.ReplicaFetcherManager)
[2016-04-28 08:22:41,754] INFO [ReplicaFetcherManager on broker 1] Added fetcher for partitions List() (kafka.server.ReplicaFetcherManager)
[2016-04-28 08:22:41,756] ERROR [KafkaApi-1] error when handling request Name:UpdateMetadataRequest;Version:1;Controller:2;ControllerEpoch:88;CorrelationId:4;ClientId:2;AliveBrokers:1 : (EndPoint(10.0.0.9,9092,PLAINTEXT)),2 : (EndPoint(10.0.0.9,9093,PLAINTEXT));PartitionState:[pipeline,1] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:72,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:1,2),[pipeline,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:74,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:2,1),[pipeline,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:74,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:2,1) (kafka.server.KafkaApis)
kafka.common.ControllerMovedException: Broker 1 received update metadata request with correlation id 4 from an old controller 2 with epoch 88. Latest known controller epoch is 89
	at kafka.server.ReplicaManager.maybeUpdateMetadataCache(ReplicaManager.scala:574)
	at kafka.server.KafkaApis.handleUpdateMetadataRequest(KafkaApis.scala:160)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:74)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-04-28 08:22:41,761] INFO New leader is 1 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-04-28 08:22:41,762] INFO New leader is 1 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-04-28 08:24:58,364] INFO [Group Metadata Manager on Broker 1]: Removed 0 expired offsets in 1 milliseconds. (kafka.coordinator.GroupMetadataManager)
