[2016-04-26 03:10:30,522] INFO [Group Metadata Manager on Broker 2]: Removed 0 expired offsets in 132 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-04-26 03:10:30,536] INFO Partition [pipeline,0] on broker 2: Shrinking ISR for partition [pipeline,0] from 2,1 to 2 (kafka.cluster.Partition)
[2016-04-26 03:10:30,612] WARN [ReplicaFetcherThread-0-1], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@56a97ce3. Possible cause: java.io.IOException: Connection to 1 was disconnected before the response was read (kafka.server.ReplicaFetcherThread)
[2016-04-26 03:10:31,512] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-04-26 03:10:31,512] INFO Partition [pipeline,2] on broker 2: Shrinking ISR for partition [pipeline,2] from 2,1 to 2 (kafka.cluster.Partition)
[2016-04-26 03:10:31,513] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-04-26 03:10:31,514] INFO 2 successfully elected as leader (kafka.server.ZookeeperLeaderElector)
[2016-04-26 03:10:31,581] INFO re-registering broker info in ZK for broker 2 (kafka.server.KafkaHealthcheck)
[2016-04-26 03:10:33,107] INFO Partition [pipeline,0] on broker 2: Expanding ISR for partition [pipeline,0] from 2 to 2,1 (kafka.cluster.Partition)
[2016-04-26 03:10:33,108] INFO Partition [pipeline,2] on broker 2: Expanding ISR for partition [pipeline,2] from 2 to 2,1 (kafka.cluster.Partition)
[2016-04-26 03:10:33,645] INFO Creating /brokers/ids/2 (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-04-26 03:10:33,646] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-04-26 03:10:33,647] INFO Registered broker 2 at path /brokers/ids/2 with addresses: PLAINTEXT -> EndPoint(10.0.0.9,9093,PLAINTEXT) (kafka.utils.ZkUtils)
[2016-04-26 03:10:33,647] INFO done re-registering broker (kafka.server.KafkaHealthcheck)
[2016-04-26 03:10:33,647] INFO Subscribing to /brokers/topics path to watch for new topics (kafka.server.KafkaHealthcheck)
[2016-04-26 03:10:33,650] INFO New leader is 2 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-04-26 03:10:33,704] ERROR [KafkaApi-2] error when handling request Name:UpdateMetadataRequest;Version:1;Controller:2;ControllerEpoch:17;CorrelationId:0;ClientId:2;AliveBrokers:1 : (EndPoint(10.0.0.9,9092,PLAINTEXT)),2 : (EndPoint(10.0.0.9,9093,PLAINTEXT));PartitionState:[pipeline,1] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:12,ControllerEpoch:16),ReplicationFactor:2),AllReplicas:1,2),[pipeline,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:14,ControllerEpoch:16),ReplicationFactor:2),AllReplicas:2,1),[pipeline,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:14,ControllerEpoch:16),ReplicationFactor:2),AllReplicas:2,1) (kafka.server.KafkaApis)
kafka.common.ControllerMovedException: Broker 2 received update metadata request with correlation id 0 from an old controller 2 with epoch 17. Latest known controller epoch is 18
	at kafka.server.ReplicaManager.maybeUpdateMetadataCache(ReplicaManager.scala:574)
	at kafka.server.KafkaApis.handleUpdateMetadataRequest(KafkaApis.scala:160)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:74)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-04-26 03:10:33,707] ERROR [KafkaApi-2] error when handling request Name:UpdateMetadataRequest;Version:1;Controller:2;ControllerEpoch:17;CorrelationId:2;ClientId:2;AliveBrokers:1 : (EndPoint(10.0.0.9,9092,PLAINTEXT)),2 : (EndPoint(10.0.0.9,9093,PLAINTEXT));PartitionState:[pipeline,1] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:12,ControllerEpoch:16),ReplicationFactor:2),AllReplicas:1,2),[pipeline,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:14,ControllerEpoch:16),ReplicationFactor:2),AllReplicas:2,1),[pipeline,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:14,ControllerEpoch:16),ReplicationFactor:2),AllReplicas:2,1) (kafka.server.KafkaApis)
kafka.common.ControllerMovedException: Broker 2 received update metadata request with correlation id 2 from an old controller 2 with epoch 17. Latest known controller epoch is 18
	at kafka.server.ReplicaManager.maybeUpdateMetadataCache(ReplicaManager.scala:574)
	at kafka.server.KafkaApis.handleUpdateMetadataRequest(KafkaApis.scala:160)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:74)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-04-26 03:10:33,721] ERROR [KafkaApi-2] error when handling request Name:UpdateMetadataRequest;Version:1;Controller:2;ControllerEpoch:17;CorrelationId:4;ClientId:2;AliveBrokers:1 : (EndPoint(10.0.0.9,9092,PLAINTEXT)),2 : (EndPoint(10.0.0.9,9093,PLAINTEXT));PartitionState:[pipeline,1] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:13,ControllerEpoch:17),ReplicationFactor:2),AllReplicas:1,2),[pipeline,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:15,ControllerEpoch:17),ReplicationFactor:2),AllReplicas:2,1),[pipeline,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:15,ControllerEpoch:17),ReplicationFactor:2),AllReplicas:2,1) (kafka.server.KafkaApis)
kafka.common.ControllerMovedException: Broker 2 received update metadata request with correlation id 4 from an old controller 2 with epoch 17. Latest known controller epoch is 18
	at kafka.server.ReplicaManager.maybeUpdateMetadataCache(ReplicaManager.scala:574)
	at kafka.server.KafkaApis.handleUpdateMetadataRequest(KafkaApis.scala:160)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:74)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-04-26 03:10:33,722] INFO New leader is 1 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-04-26 03:26:12,151] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-04-26 03:26:12,154] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-04-26 03:26:12,154] INFO 2 successfully elected as leader (kafka.server.ZookeeperLeaderElector)
[2016-04-26 03:26:12,189] INFO re-registering broker info in ZK for broker 2 (kafka.server.KafkaHealthcheck)
[2016-04-26 03:26:13,066] INFO Creating /brokers/ids/2 (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-04-26 03:26:13,070] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-04-26 03:26:13,070] INFO Registered broker 2 at path /brokers/ids/2 with addresses: PLAINTEXT -> EndPoint(10.0.0.9,9093,PLAINTEXT) (kafka.utils.ZkUtils)
[2016-04-26 03:26:13,070] INFO done re-registering broker (kafka.server.KafkaHealthcheck)
[2016-04-26 03:26:13,070] INFO Subscribing to /brokers/topics path to watch for new topics (kafka.server.KafkaHealthcheck)
[2016-04-26 03:26:13,075] INFO New leader is 2 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-04-26 03:26:13,108] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [pipeline,2],[pipeline,0] (kafka.server.ReplicaFetcherManager)
[2016-04-26 03:26:13,109] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions  (kafka.server.ReplicaFetcherManager)
[2016-04-26 03:26:13,109] INFO [ReplicaFetcherManager on broker 2] Added fetcher for partitions List() (kafka.server.ReplicaFetcherManager)
[2016-04-26 03:26:13,120] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [pipeline,2],[pipeline,0] (kafka.server.ReplicaFetcherManager)
[2016-04-26 03:26:13,121] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions  (kafka.server.ReplicaFetcherManager)
[2016-04-26 03:26:13,121] INFO [ReplicaFetcherManager on broker 2] Added fetcher for partitions List() (kafka.server.ReplicaFetcherManager)
