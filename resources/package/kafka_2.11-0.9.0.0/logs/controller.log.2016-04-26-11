[2016-04-26 12:18:59,287] TRACE [Controller 2]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-04-26 12:18:59,356] DEBUG [Controller 2]: preferred replicas by broker Map(2 -> Map([pipeline,2] -> List(2, 1), [pipeline,0] -> List(2, 1)), 1 -> Map([pipeline,1] -> List(1, 2))) (kafka.controller.KafkaController)
[2016-04-26 12:18:59,361] DEBUG [Controller 2]: topics not in preferred replica Map([pipeline,2] -> List(2, 1), [pipeline,0] -> List(2, 1)) (kafka.controller.KafkaController)
[2016-04-26 12:18:59,368] TRACE [Controller 2]: leader imbalance ratio for broker 2 is 1.000000 (kafka.controller.KafkaController)
[2016-04-26 12:18:59,406] INFO [Controller 2]: Starting preferred replica leader election for partitions [pipeline,2] (kafka.controller.KafkaController)
[2016-04-26 12:18:59,408] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [pipeline,2] (kafka.controller.PartitionStateMachine)
[2016-04-26 12:18:59,929] INFO [SessionExpirationListener on 2], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2016-04-26 12:19:00,048] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [pipeline,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-04-26 12:19:00,066] WARN [Controller 2]: Partition [pipeline,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-04-26 12:19:00,067] INFO [Controller 2]: Starting preferred replica leader election for partitions [pipeline,0] (kafka.controller.KafkaController)
[2016-04-26 12:19:00,067] INFO [Partition state machine on Controller 2]: Invoking state change to OnlinePartition for partitions [pipeline,0] (kafka.controller.PartitionStateMachine)
[2016-04-26 12:19:00,068] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [pipeline,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-04-26 12:19:00,069] WARN [Controller 2]: Partition [pipeline,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-04-26 12:19:00,069] DEBUG [Controller 2]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-04-26 12:19:00,069] TRACE [Controller 2]: leader imbalance ratio for broker 1 is 0.000000 (kafka.controller.KafkaController)
[2016-04-26 12:19:00,069] DEBUG [Controller 2]: Controller resigning, broker id 2 (kafka.controller.KafkaController)
[2016-04-26 12:19:00,069] DEBUG [Controller 2]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2016-04-26 12:19:00,070] INFO [Partition state machine on Controller 2]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2016-04-26 12:19:00,070] INFO [Replica state machine on controller 2]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2016-04-26 12:19:00,073] INFO [Controller-2-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2016-04-26 12:19:00,073] INFO [Controller-2-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2016-04-26 12:19:00,073] INFO [Controller-2-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2016-04-26 12:19:00,074] INFO [Controller-2-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2016-04-26 12:19:00,074] INFO [Controller-2-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2016-04-26 12:19:00,074] INFO [Controller-2-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2016-04-26 12:19:00,075] INFO [Controller 2]: Broker 2 resigned as the controller (kafka.controller.KafkaController)
[2016-04-26 12:19:01,278] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2016-04-26 12:19:01,281] DEBUG Sending MetadataRequest to Brokers:ArrayBuffer(1, 2) for TopicAndPartitions:Set([pipeline,1]) (kafka.controller.IsrChangeNotificationListener)
[2016-04-26 12:19:01,282] ERROR Haven't been able to send metadata update requests, current state of the map is Map(2 -> Map(pipeline-1 -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:26,ControllerEpoch:35),ReplicationFactor:2),AllReplicas:1,2)), 1 -> Map(pipeline-1 -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:26,ControllerEpoch:35),ReplicationFactor:2),AllReplicas:1,2))) (kafka.controller.ControllerBrokerRequestBatch)
[2016-04-26 12:19:01,282] ERROR [Controller 2]: Forcing the controller to resign (kafka.controller.KafkaController)
[2016-04-26 12:19:01,320] INFO [BrokerChangeListener on Controller 2]: Broker change listener fired for path /brokers/ids with children 1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2016-04-26 12:19:01,325] INFO [AddPartitionsListener on 2]: Add Partition triggered {"version":1,"partitions":{"2":[2,1],"1":[1,2],"0":[2,1]}} for path /brokers/topics/pipeline (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-04-26 12:44:23,707] INFO [SessionExpirationListener on 2], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2016-04-26 12:44:23,710] DEBUG [Controller 2]: Controller resigning, broker id 2 (kafka.controller.KafkaController)
[2016-04-26 12:44:23,710] DEBUG [Controller 2]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2016-04-26 12:44:23,710] INFO [Partition state machine on Controller 2]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2016-04-26 12:44:23,710] INFO [Replica state machine on controller 2]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2016-04-26 12:44:23,710] INFO [Controller 2]: Broker 2 resigned as the controller (kafka.controller.KafkaController)
