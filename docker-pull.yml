#project_name : ServiceDiscovery
version : '2'

services :
  zookeeper :
    image : bhavneshgugnani/zookeeper:latest

  broker :
    image : bhavneshgugnani/broker:latest
    depends_on :
      - zookeeper
    links :
      - zookeeper
    entrypoint : ./wait-for-it.sh zookeeper:2181 -- bin/kafka-server-start.sh config/server.properties

  producer :
    image : bhavneshgugnani/producer:latest
    depends_on :
      - broker
    links :
      - broker
    entrypoint : ./wait-for-it.sh broker:9092 -- python TweetProducer.py

  consumer :
    image : bhavneshgugnani/consumer:latest
    depends_on :
      - broker
    links :
      - broker
    entrypoint : ./wait-for-it.sh broker:9092 -- python TweetConsumer.py broker 9092 Trump
  
  mongodb :
    image : mongo
    entrypoint : /usr/bin/mongod --dbpath ${DB_PATH}
    environment :
      - DB_PATH=${DB_PATH}
    volumes :
      - ${DB_PATH}:${DB_PATH}

  #orchestrator :
  #  image : bhavneshgugnani/orchestrator:latest
  #  links :
  #    - mongodb
  #    - broker